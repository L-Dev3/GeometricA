<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <title>RA com Cubo e Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  
  <!-- A-Frame + AR.js -->
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>

  <!-- CSS -->
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <!-- LOGIN -->
  <div id="login">
    <h2>Entrar</h2>
    <input id="nome" placeholder="Seu nome">
    <input id="senha" type="password" placeholder="Senha">
    <button onclick="registrarOuEntrar()">Entrar</button>
  </div>

  <!-- PAINEL INFORMATIVO -->
  <div id="painelInfo">
    <h3>Informações</h3>
    <p id="textoInfo">Toque em um número no cubo.</p>
    <button onclick="abrirDesafios()">Desafios dessa figura</button>
  </div>

  <!-- DROPDOWN DE DESAFIOS -->
  <div id="menuDesafios">
    <img src="https://cdn-icons-png.flaticon.com/512/1034/1034159.png" onclick="toggleDropdown()">
    <div id="dropdown">
      <button onclick="abrirDesafios()">Ir para Desafios</button>
    </div>
  </div>

  <!-- CENA A-FRAME COM AR -->
  <a-scene
    embedded
    renderer="logarithmicDepthBuffer: true;"
    arjs="sourceType: webcam; detectionMode: mono; debugUIEnabled: false;"
  >
    <!-- Ativos do modelo -->
    <a-assets>
      <a-asset-item id="modelo" src="Cubo2.0.glb"></a-asset-item>
    </a-assets>

    <!-- Marcador com modelo -->
    <a-marker preset="hiro">
      <a-entity 
        gltf-model="#modelo"
        scale="0.5 0.5 0.5"
        position="0 0 0"
        animation-mixer>
      </a-entity>

      <!-- Botões flutuantes com informações -->
      <a-text value="1" position="-1 1.5 0" color="white"
              geometry="primitive: plane; height: 0.4; width: 0.4"
              material="color: red; opacity: 0.8"
              class="botao" data-info="O cubo tem 6 faces quadradas."></a-text>

      <a-text value="2" position="0 1.5 0" color="white"
              geometry="primitive: plane; height: 0.4; width: 0.4"
              material="color: green; opacity: 0.8"
              class="botao" data-info="O cubo tem 12 arestas."></a-text>

      <a-text value="3" position="1 1.5 0" color="white"
              geometry="primitive: plane; height: 0.4; width: 0.4"
              material="color: blue; opacity: 0.8"
              class="botao" data-info="O cubo tem 8 vértices."></a-text>
    </a-marker>

    <!-- Câmera e iluminação -->
    <a-entity camera></a-entity>
    <a-light type="ambient" color="white" intensity="1"></a-light>
    <a-light type="directional" color="white" intensity="1.5" position="-1 1 1"></a-light>
    <a-light type="directional" color="white" intensity="1.5" position="1 1 1"></a-light>
  </a-scene>

  <!-- SCRIPT JS -->
  <script>
    // Login
    function registrarOuEntrar() {
      const nome = document.getElementById("nome").value;
      const senha = document.getElementById("senha").value;
      let contas = JSON.parse(localStorage.getItem("contas") || "{}");

      if (contas[nome]) {
        if (contas[nome] !== senha) {
          alert("Senha incorreta!");
          return;
        }
      } else {
        contas[nome] = senha;
        localStorage.setItem("contas", JSON.stringify(contas));
      }

      localStorage.setItem("usuarioAtual", nome);
      document.getElementById("login").style.display = "none";
    }

    // Mostrar informações do cubo
    document.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll('.botao').forEach(botao => {
        botao.addEventListener('click', function () {
          const info = this.getAttribute('data-info');
          document.getElementById("textoInfo").textContent = info;
          document.getElementById("painelInfo").style.display = "block";
        });
      });
    });

    // Dropdown
    function toggleDropdown() {
      const drop = document.getElementById("dropdown");
      drop.style.display = drop.style.display === "none" ? "block" : "none";
    }

    // Desafio
    function abrirDesafios() {
      const usuario = localStorage.getItem("usuarioAtual");
      const resposta = prompt("Quantas faces tem um cubo?");
      if (resposta === "6") {
        alert("Correto!");
        salvarProgresso(usuario, "cubo_faces", true);
      } else {
        alert("Errado! São 6 faces.");
        salvarProgresso(usuario, "cubo_faces", false);
      }
    }

    // Salvar progresso
    function salvarProgresso(usuario, desafioID, acertou) {
      let progresso = JSON.parse(localStorage.getItem("progresso") || "{}");
      if (!progresso[usuario]) progresso[usuario] = {};
      progresso[usuario][desafioID] = acertou;
      localStorage.setItem("progresso", JSON.stringify(progresso));
    }
  </script>
</body>
</html>

